<%doc>

Example:

  <SCRIPT TYPE="text/javascript" SRC="overlibmws.js"></SCRIPT>
  <SCRIPT TYPE="text/javascript" SRC="iframecontentmws.js"></SCRIPT>

  include( '/elements/popup_link.html', { #hashref or a list, either way is fine

    #required
    'action'         => 'content.html', # uri for content of popup
    'label'          => 'click me',     # text of <A> tag
   
    #strongly recommended
    'actionlabel     => 'You clicked',  # popup title
   
    #opt
    'width'          => '540',
    'color'          => '#ff0000',
    'closetext'      => 'Go Away',      # the value '' removes the link
  } )

</%doc>
% if ($action && $label) {
<A HREF="javascript:void(0);" onClick="<% $onclick %>"><% $label %></A>\
% }
<%init>

my($action, $label, $actionlabel) = ( '', '', '' );
my $closetext = 'Close';
my $width = 540;
my $color = '#333399';

my $params;
if (ref($_[0]) eq 'HASH') {
  #$params = { %$params, %{ $_[0] } };
  $params = shift;
} else {
  #$params = { %$params, @_ };
  $params = { @_ };
}

$action      = $params->{'action'}      if exists $params->{'action'};
$label       = $params->{'label'}       if exists $params->{'label'};
$actionlabel = $params->{'actionlabel'} if exists $params->{'actionlabel'};
$width       = $params->{'width'}       if exists $params->{'width'};
$color       = $params->{'color'}       if exists $params->{'color'};
$closetext   = $params->{'closetext'}   if exists $params->{'closetext'};

#stupid safari is caching the "location" of popup iframs, and submitting them
#instead of displaying them.  this should prevent that.
my $popup_name = 'popup-'.time. "-$$-". rand() * 2**32;

my $onclick = "overlib( OLiframeContent('$action', $width, 336, '$popup_name' ), CAPTION, '$actionlabel', STICKY, AUTOSTATUSCAP, MIDX, 0, MIDY, 0, DRAGGABLE, CLOSECLICK, BGCOLOR, '$color', CGCOLOR, '$color', CLOSETEXT, '$closetext' ); return false;";

</%init>
