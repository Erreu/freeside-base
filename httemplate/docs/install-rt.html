<head>
  <title>Installing integrated RT ticketing</title>
</head>
<body>
<h1>Installing integrated RT ticketing</h1>

<p><i>Integrated ticketing is an new feature and these instructions are preliminary.  Documentation contributions are welcome.</i>

<p><i>There is also support for running this integration against an external RT installation, but it is not (yet) documented.</i>

<p>Perl minimum version 5.8.3 is required.  HTML::Mason is required.

<p>Install the following perl modules:
  <ul>
    <li><a href="http://search.cpan.org/search?dist=Apache-Session">Apache::Session</a>
    <li><a href="http://search.cpan.org/search?dist=HTML-Tree">HTML::TreeBuilder (HTML-Tree)</a>
    <li><a href="http://search.cpan.org/search?dist=HTML-Format">HTML::FormatText (HTML-Format)</a>
    <li><a href="http://search.cpan.org/search?dist=Test-Inline">Test::Inline</a>
    <li><a href="http://search.cpan.org/search?dist=Class-ReturnValue">Class::ReturnValue</a>
    <li><a href="http://search.cpan.org/search?dist=DBIx-SearchBuilder">DBIx::SearchBuilder</a>
    <li><a href="http://search.cpan.org/search?dist=Log-Dispatch">Log::Dispatch</a>
    <li><a href="http://search.cpan.org/search?dist=Locale-Maketext-Lexicon">Locale::Maketext::Lexicon</a>
    <li><a href="http://search.cpan.org/search?dist=Locale-Maketext-Fuzzy">Locale::Maketext::Fuzzy</a>
    <li><a href="http://search.cpan.org/search?dist=Text-Wrapper">Text::Wrapper</a>
    <li><a href="http://search.cpan.org/search?dist=Time-modules">Time::ParseDate (Time-modules)</a>
    <li><a href="http://search.cpan.org/search?dist=TermReadKey">Term::ReadKey (TermReadKey)</a>
    <li><a href="http://search.cpan.org/search?dist=Text-Autoformat">Text::Autoformat</a>
    <li><a href="http://search.cpan.org/search?dist=Text-Quoted">Text::Quoted</a>
    <li><a href="http://search.cpan.org/search?dist=Regexp-Common">Regexp::Common</a>
    <li><a href="http://search.cpan.org/search?dist=HTML-Scrubber">HTML::Scrubber</a>
    <li><a href="http://search.cpan.org/search?dist=Tree-Simple">Tree::Simple</a>
  </ul>

<p>Create a new Unix group called 'rt'

<p>Edit the top-level Makefile, set RT_ENABLED to 1 and set the RT_DOMAIN, RT_TIMEZONE, and FREESIDE_URL variables.

<p><pre>make configure-rt
make create-rt
make install-rt
</pre>

<p>Add the following to your httpd.conf:
<pre>
# replace /var/www/freeside with your freeside document root
&lt;DirectoryMatch "^/var/www/freeside/rt/.*NoAuth"&gt;
&lt;Limit GET POST&gt;
allow from all
Satisfy any   
SetHandler perl-script
PerlHandler HTML::Mason
&lt;/Limit&gt;
&lt;/DirectoryMatch&gt;
# replace /var/www/freeside with your freeside document root
&lt;DirectoryMatch "^/var/www/freeside/rt/.*NoAuth/images"&gt;
SetHandler None
&lt;/DirectoryMatch&gt;
# replace /var/www/freeside with your freeside document root
&lt;Directory /var/www/freeside/rt/Ticket/Attachment&gt; 
SetHandler perl-script 
PerlHandler HTML::Mason 
&lt;/Directory&gt;
</pre>

<p>Set the <b>ticket_system</b> configuration value to <b>RT_Internal</b>.  You may also wish to set <b>ticket_system-default_queueid</b> once you have RT configured.

<p>Bootstrap RT's permissions:
  <ul>
    <li>Click on "Ticketing Main" on the Freeside main menu to auto-create an RT login for your username
    <li>Run <code>freeside-adduser -h /usr/local/etc/freeside/htpasswd root</code> and set a (temporary) password
    <li>Log into your Freeside installation as the "root" user you just created, by closing your browser or using <code>https://root@yourmachone/freeside/</code> syntax.
    <li>Click on "Ticketing Main" on the Freeside main menu.  Click on "Configuration", then "Global", and then "User Rights".  Grant the "SuperUser" right to your RT login.
    <li>Remove the temporary "root" user from /usr/local/etc/freeside/mapsecrets and /usr/local/etc/freeside/htpasswd
  </ul>

<p>Follow the <A HREF="http://wiki.bestpractical.com/">regular RT documentation</A> to configure RT, setup the mailgate, etc.

</body>
