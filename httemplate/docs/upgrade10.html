<pre>
this is incomplete

install DBIx::DBSchema 0.21

install NetAddr::IP and Chart::Base

CREATE TABLE cust_bill_pkg_detail (
  detailnum serial,
  pkgnum int NOT NULL,
  invnum int NOT NULL,
  detail varchar(80),
  PRIMARY KEY (detailnum)
);
CREATE INDEX cust_bill_pkg_detail1 ON cust_bill_pkg_detail ( pkgnum, invnum );

CREATE TABLE part_virtual_field (
  vfieldpart int NOT NULL,
  dbtable varchar(32) NOT NULL,
  name varchar(32) NOT NULL,
  check_block text,
  list_source text,
  length integer,
  label varchar(80),
  PRIMARY KEY (vfieldpart)
);

CREATE TABLE virtual_field (
  recnum integer NOT NULL,
  vfieldpart integer NOT NULL,
  value varchar(128) NOT NULL,
  PRIMARY KEY (vfieldpart, recnum)
);

CREATE TABLE router (
  routernum serial,
  routername varchar(80),
  svcnum int,
  PRIMARY KEY (routernum)
);

CREATE TABLE part_svc_router (
  svcpart int NOT NULL,
  routernum int NOT NULL
);

CREATE TABLE addr_block (
  blocknum serial,
  routernum int NOT NULL,
  ip_gateway varchar(15) NOT NULL,
  ip_netmask int NOT NULL,
  PRIMARY KEY (blocknum)
);
CREATE UNIQUE INDEX addr_block1 ON addr_block ( blocknum, routernum );

CREATE TABLE svc_broadband (
  svcnum int NOT NULL,
  blocknum int NOT NULL,
  speed_up int NOT NULL,
  speed_down int NOT NULL,
  ip_addr varchar(15),
  PRIMARY KEY (svcnum)
);

DELETE INDEX cust_bill_pkg1;

ALTER TABLE cust_bill_pkg ADD itemdesc varchar(80) NULL;
ALTER TABLE h_cust_bill_pkg ADD itemdesc varchar(80) NULL;
ALTER TABLE cust_main_county ADD taxname varchar(80) NULL;
ALTER TABLE h_cust_main_county ADD taxname varchar(80) NULL;
ALTER TABLE cust_pkg ADD last_bill int NULL;
ALTER TABLE h_cust_pkg ADD last_bill int NULL;

dump database, edit:
- cust_main: increase otaker from 8 to 32
- cust_main: change ss from char(11) to varchar(11)
- cust_credit: increase otaker from 8 to 32
- cust_pkg: increase otaker from 8 to 32
- cust_refund: increase otaker from 8 to 32
- domain_record: increase reczone from 80 to 255
- domain_record: change rectype from char to varchar
- domain_record: increase recdata from 80 to 255
then reload

optionally:

  CREATE INDEX cust_main6 ON cust_main ( daytime );
  CREATE INDEX cust_main7 ON cust_main ( night );
  CREATE INDEX cust_main8 ON cust_main ( fax );
  CREATE INDEX cust_main9 ON cust_main ( ship_daytime );
  CREATE INDEX cust_main10 ON cust_main ( ship_night );
  CREATE INDEX cust_main11 ON cust_main ( ship_fax );

  serial columns

mandatory again:

dbdef-create username
create-history-tables username cust_bill_pkg_detail router part_svc_router addr_block svc_broadband
dbdef-create username



</pre>
