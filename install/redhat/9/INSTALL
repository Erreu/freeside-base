#!/bin/sh

wget --passive-ftp --continue http://download.fedora.us/fedora/redhat/9/i386/RPMS.stable/apt-0.5.5cnc6-0.fdr.8.rh90.i386.rpm
rpm -i apt*i386.rpm
#cp sources.list /etc/apt/
apt-get update

apt-get install krb5-devel perl-CGI perl-CPAN perl-DateManip perl-HTML-Parser perl-HTML-Tagset perl-TimeDate perl-URI perl-libwww-perl perl-suidperl rsync postgresql postgresql-docs postgresql-libs postgresql-server screen zsh lftp cvs gcc # perl-DBD-MySQL # perl-suidperl gd openssh

wget --passive-ftp --continue http://dl.atrpms.net/production/packages/redhat-9-i386/atrpms/perl-GD-2.16-10.rh9.at.i386.rpm http://dl.atrpms.net/production/packages/common/atrpms/atrpms-61-1.at.noarch.rpm http://dl.atrpms.net/testing/packages/redhat-9-i386/atrpms/gd-2.0.28-1_10.rh9.at.i386.rpm http://dl.atrpms.net/testing/packages/redhat-9-i386/atrpms/libgd2-2.0.28-1_10.rh9.at.i386.rpm

#cp /etc/apt/apt.conf /etc/apt/apt.conf.real

rpm -i atrpms*.rpm libgd2*i386.rpm gd-2*i386.rpm perl-GD*i386.rpm 

#mv /etc/apt/apt.conf.real /etc/apt/apt.conf

apt-get install perl-MIME-tools

perl -MCPAN -e"install Locale::Country, Business::CreditCard, \
                       Mail::Internet, File::CounterFile, FreezeThaw, \
                       String::Approx, Text::Template, DBIx::DataSource, \
                       DBIx::DBSchema, Net::SSH, String::ShellQuote, \
                       Net::SCP, HTML::Mason, Tie::IxHash, Time::Duration, \
                       HTML::Widgets::SelectLayers, Apache::DBI, \
                       Cache::Cache, Test::Pod, NetAddr::IP, IPC::ShareLite, \
                       Chart::LinesPoints, Net::Whois::Raw, \
                       Locale::SubCountry, Crypt::PasswdMD5, DBI, DBD::Pg, \
                       JavaScript::RPC::Server::CGI, Text::CSV_XS, \
                       Spreadsheet::WriteExcel, Frontier::RPC2, \
                       File::Temp, Storable"

apt-get remove httpd mod_perl mod_ssl
#apachetoolbox
lftpget http://easynews.dl.sourceforge.net/sourceforge/apachetoolbox/Apachetoolbox-install-1.5.72.tar.gz
tar xzvf Apachetoolbox-install-1.5.72.tar.gz
(cd Apachetoolbox-1.5.72; sh install.sh)
# 4
# 16
# go
# export INCLUDES="-I/usr/kerberos/include"
cd apache_1.3.31;make
#make certificate TYPE=dummy
make install


#apache config
#apache init script 

/usr/sbin/useradd freeside

/sbin/chkconfig postgresql on
/etc/init.d/postgresql start

su postgres -c "createuser -P freeside"

su freeside -c "createdb freeside"

#?
cd ../../..
make install-perl-modules
make create-config
freeside-adduser -c -h /usr/local/etc/freeside/htpasswd ivan
su freeside -c 'freeside-setup ivan'
su freeside -c '/home/ivan/freeside/bin/populate-msgcat ivan'
make deploy

